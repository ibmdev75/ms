!function(e){var n=function(){e(document).idleTimer(500,{name:"Hover"});e(document).on("Hover.idle",function(q){var p=e(q.timer.target);if(p.closest("DIV.popover.tt").exists()){return}if(p.closest(".dropdown-menu").exists()){return}f(p);b(p)});e(document).on("click",".ctxTooltipMenu",function(q){var p=e(q.currentTarget);b(p,true)});e(document).on("click",".ctxTooltipCard",function(q){var p=e(q.currentTarget);f(p,true)});e(document).on("mouseup",d);e(document).on("jalios:refresh",h)};var d=function(q){var p=e(q.target);if(!p.is("BUTTON.close")&&p.closest("DIV.popover.tt").exists()){return}if(p.data("bs.popover")){return}e("DIV.popover.tt").not(".tt-static").removeClass("in").hide()};var h=function(q){var p=e.jalios.Event.match(q,"refresh","before");if(!p){return}e("DIV.popover.tt").not(p.$target).removeClass("in").hide()};var j='<div class="popover tt-card tt no-focus"><div class="arrow"></div><button class="close" type="button">Ã—</button><div class="popover-content ajax-refresh-div"></div></div>';var f=function(q,x){if(!q){return}if(e("BODY").hasClass("jcms-ttcard-disabled")){return}if(!q.is(".ctxTooltipCard")){var q=q.parent("A.ctxTooltipCard");if(!q.exists()){return}}if(q.prop("tagName")=="A"&&x){return}if(i(q,x)){return}if(q.closest(".noTooltipCard").exists()){return}var w=q.data("bs.popover");var v=q.data("popover-html");var u=w?w.tip():null;e("DIV.popover.tt").not(u).removeClass("in").hide();var s=(new Date()).getTime();if(v&&g+2000>s){q.popover({trigger:"manual",html:true,container:"body",delay:{show:500,hide:10000},template:j,content:v}).popover("show");return}g=s;var r=q.getJcmsId();var t=q.attr("class").replace("ID_"+r,"").replace("ctxTooltipCard","").replace(/^\s+|\s+$/g,"").replace(/\s+/g,"|");var p="jcore/tooltip/ttCard.jsp?ttId="+r+"&ttContext="+t;e.ajax({url:p,dataType:"html",cache:true,success:function(y){var z=e("<DIV/>").html(y);z.imagesLoaded(function(){q.popover({trigger:"manual",html:true,container:"body",delay:{show:500,hide:10000},template:j,placement:"auto",content:y}).popover("show");w=q.data("bs.popover");w.refreshInProgress=true;q.data("popover-html",v);if(!y){w.refreshInProgress=false;u.hide();return}w.refreshInProgress=false})}})};var k=function(){};var g=0;var m=function(){var p=e(this);return p.data("popover-html")||j};var c='<div class="popover tt tip no-focus"><div class="arrow"></div><div class="popover-content ajax-refresh-div"></div></div>';var b=function(p,q){if(!p){return}if(!p.is(".ctxTooltipMenu")){return}if(p.prop("tagName")=="A"&&q){return}if(i(p,q)){return}var r=p.offset();if(r.top==0&&r.left==0){return}p.popover({trigger:"manual",html:true,container:"body",delay:{show:1000,hide:5000},template:c,content:o});a.call(p[0]);p.popover("show")};var o=function(){var p=e(this);return p.data("popover-html")||c};var a=function(){var u=e(this);var s=u.data("popover-html");var t=u.data("bs.popover");var w=u.data("bs.popover").tip();if(t.refreshInProgress==true){return s}e("DIV.popover.tt").not(w).removeClass("in").hide();var q=(new Date()).getTime();if(s&&g+2000>q){return l(u,w,s)}g=q;var p=u.attr("longDesc")||u.attr("data-jalios-tt-url");if(p){p+=(p.indexOf("?")>0?"&":"?")+"d="+(new Date()).getTime();u.refresh({url:p,target:w.find(".popover-content"),nohistory:true,noscroll:true,callback:function(x,y){if(!y){t.refreshInProgress=false;w.hide();return}t.refreshInProgress=true;l(u,w,y,true);t.show();t.refreshInProgress=false}})}else{if(u.attr("title")){var v='<p class="tip-content">'+u.attr("title")+"</p>";u.removeAttr("title");l(u,w,v);return v}else{if(u.attr("data-original-title")){var v='<p class="tip-content">'+u.attr("data-original-title")+"</p>";u.removeAttr("data-original-title");l(u,w,v);return v}else{if(s){l(u,w,s);return s}else{var r=u.nextAll(".ctxTooltip");if(!r.exists()){r=u.parent().nextAll(".ctxTooltip")}l(u,w,r.first().html());t.show()}}}}return"..."};var l=function(r,s,p,q){if(!p){s.hide();return}if(!q){s.find(".popover-content").html(p)}r.data("popover-html",p);return p};var i=function(q,r){if(!q.data("bs.popover")){return false}var s=q.data("bs.popover").$tip;if(s.hasClass("in")){if(r){s.removeClass("in").hide()}return true}var p=(new Date()).getTime();if(g+10000<p){return false}e("DIV.popover.tt").removeClass("in").hide();q.popover("show");return true};e(document).ready(function(p){n()})}(window.jQuery);