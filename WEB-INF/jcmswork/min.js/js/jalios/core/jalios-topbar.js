(function(b){b.fn.topbar=function(){var d=function(){};var c=b(".topbar .topbar-search-wrapper");var e={searchContainer:c.find(".search-container:eq(0)"),inputElem:c.find(".topbar-search-query"),filterElem:c.find(".search-filter"),listElem:c.find(".search-list"),init:function(){var h=parseInt(c.find(".result-label").css("width"),10);var i=parseInt(c.find(".result-group").css("width"),10)-parseInt(h,10);var j=e.searchContainer.width();e.inputElem.on("focus",function(){e.searchContainer.addClass("focused");if(b(window).width()<480){e.searchContainer.css("width",b(window).width())}e.filterElem.animate({opacity:1},250)});e.searchContainer.on("click",function(){e.searchContainer.addClass("focused");if(b(window).width()<480){e.searchContainer.css("width",b(window).width())}e.filterElem.animate({opacity:1},250);e.inputElem.focus()});b(document).mouseup(function(m){var k=b(m.target);var l=k.exists()&&k.closest(".typeahead-search-topbar").exists();if(!l&&!c.is(m.target)&&c.has(m.target).length===0){e.searchContainer.css("width","");e.filterElem.animate({opacity:0},250);e.searchContainer.removeClass("focused")}});b(".search-filter .dropdown-menu").click(function(k){k.stopPropagation()})},openList:function(){e.listElem.slideDown()},closeList:function(){e.listElem.slideUp()}};e.init();var g=b(".topbar:eq(0) .topbar-publish-wrapper:eq(0)");var f={topbarPart:g.find(".publish-topbar"),listPart:g.find(".publish-menu-container"),isMenuOpen:false,init:function(){f.listPart.find(".main-menu > .publish-menu-item").each(function(i,k){var j=b(k).find(".child-menu:eq(0)");var h=j.length;if(h){b(this).attr("data-bound",i).addClass("has-child");j.attr("data-bound",i);j.remove();b(".child-menu-container").append(j)}});f.topbarPart.on("click",function(){if(!f.isMenuOpen){f.openMenu()}else{f.closeMenu()}});f.listPart.find(".has-child").on("click",function(){var h=b(this).attr("data-bound");f.listPart.find(".child-menu-container .list-group").css("display","none");f.listPart.find(".child-menu-container [data-bound="+h+"]").css("display","block");b(".publish-slider").animate({left:"-300px"},250,"swing",function(){f.changeMenuHeight(h)})});f.listPart.find(".back").on("click",function(){b(".publish-slider").animate({left:"0"},250,"swing",function(){f.changeMenuHeight(false)})});b(document).mouseup(function(h){if(!g.is(h.target)&&g.has(h.target).length===0){if(f.isMenuOpen){f.closeMenu()}}})},changeMenuHeight:function(i){var k;if(i===false){k=b(".topbar-publish-wrapper .main-menu .publish-menu-item").length}else{k=b(".child-menu-container [data-bound="+i+"] .publish-menu-item").length}var j=parseInt(g.find(".publish-menu-container .publish-menu-item:eq(0)").css("height"),10);var h=(k*j)-((k*1)-1);b(".publish-menu-container").animate({height:h},250)},openMenu:function(){g.addClass("publish-selected");f.listPart.slideDown("fast");f.isMenuOpen=true},closeMenu:function(){var h=parseInt(g.find(".publish-menu-container .publish-menu-item:eq(0)").css("height"),10);f.listPart.slideUp(250,function(){g.removeClass("publish-selected");f.listPart.find(".child-menu-container .list-group").css("display","none");b(".publish-slider").css({left:"0"});var j=b(".topbar-publish-wrapper .main-menu .publish-menu-item").length;var i=(j*h)+(j-1);b(".publish-menu-container").css({height:i});f.isMenuOpen=false})}};f.init();b(".message").popover()};var a=function(){b("#search-space").on("input",function(c){var d=c.target.value;var e=b(c.target).data("jalios-topbar-location");b.ajax({url:"jcore/topbar/doTopbarWorkspaceList.jsp",type:"POST",data:{wsQuery:d,topbarLocation:e}}).then(function(f){b(".spaces-list").first().html(f)})});b.fn.topbar()};b(document).ready(function(){a()})}(jQuery));