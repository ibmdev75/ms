!function(i){if(!i.jalios){i.jalios={}}var s=/ajax-refresh/i;var t={trigger:false,nohistory:false,nofocus:false,noscroll:false,noerror:false,noresponse:false,isform:false,periodical:false,callback:false,inner:false,append:false,waiting:false,method:undefined,params:{},cache:false,timeout:60000};var b=function(v,w){if(!w){v.removeClass("ajax-refresh-debug");return}if(i(document.location).prop("href").indexOf("debug=true")>=0){v.addClass("ajax-refresh-debug")}};var r=function(y,v,x){if(x.nofocus||x.noscroll){return}var w=v.offset().top;var z=i(window).scrollTop()+40;if(z<w&&w<(z+i(window).height())){return}i("html,body").animate({scrollTop:v.offset().top-50},"fast")};var f=function(v,x,w){if(!x){v.removeData("ajax-refresh:job");if(w.waiting){v.removeClass("ajax-refresh-job");v.find(".ajax-job").remove()}return true}if(v.data("ajax-refresh:job")){return false}v.data("ajax-refresh:job",true);if(w.waiting){v.addClass("ajax-refresh-job");v.append('<div class="ajax-job"></div>')}return true};var n='<div class="ajax-lazy-load">';var a=function(x){x=i.jalios.Common.strip(x,true);var z="";var v=x.indexOf(n);if(v>0){z=x.substring(v+n.length,x.lastIndexOf("</div>"));x=x.substring(0,v)}var w=false;var A=new RegExp("^(<div[^>]*ajax-refresh[^>]*>)(.*)","gi");var y=A.exec(x);if(y){w=i(y[1]+"</div>");x=x.replace(A,"$2");x=x.substring(0,x.lastIndexOf("</div>"))}x+=z;return{html:x,"$wrap":w}};var m=function(w,v){var x=w.attr("data-jalios-ajax-refresh-timeout");if(x){v.timeout=parseInt(x)}};var g=function(v,w){var x=v.attr("data-jalios-ajax-refresh-waiting");if(!x){x=(v.attr("class")||"").match(/ajax-waiting-([\d\.]+)/);if(x){x=x[1]}else{return}}w.waiting=parseFloat(x)};var e=function(v,w){var x=v.attr("data-jalios-ajax-refresh-periodical");if(!x){x=(v.attr("class")||"").match(/ajax-periodical-(\d+)/);if(x){x=x[1]}else{return}}w.nohistory=true;w.nofocus=true;w.noscroll=true;w.periodical=parseInt(x)};var k=function(x,w){var v=x.attr("data-jalios-ajax-refresh-inner");if(v){w.inner=v;w.nohistory=true}};var u=function(x,w){if(w&&w.target){return i(w.target)}var A=x.attr("data-jalios-target");if(A){var v=x.attr("data-jalios-target-position");if(v){return x[this.position].apply(x,[A])}return i(A)}var z=x.closest("DIV.ajax-refresh-div");if(!z.exists()){var y=i.Event("jalios:refresh");y.refresh={};y.refresh.type="helper:target";y.refresh.$e=x;y.refresh.$target=false;i(document).trigger(y);z=y.refresh.$target}return z};var l=function(y,w,x){var z={};if(y.is("UL,OL")){z.nohistory=true;z.noscroll=true}e(w,z);e(y,z);m(w,z);m(y,z);k(w,z);k(y,z);g(w,z);g(y,z);z.trigger="#"+y.identify("jqid").attr("id");var A=y.prop("form");if(x.isform||z.isform){A=y.closest("FORM")}if(A){z.method=i(A).attr("method");z.noscroll=true;z.isform="#"+i(A).identify("jqid").attr("id")}z=i.extend(true,{},t,z,x);if(z.method&&"POST"==z.method.toUpperCase()){z.nohistory=true}var v=y.attr("data-jalios-ajax-refresh");if(v&&v.match(/nohistory/)){z.nohistory=true}if(v&&v.match(/nofocus/)){z.nofocus=true}else{if(v&&v.match(/focus/)){z.nofocus=false}}if(v&&v.match(/noscroll/)){z.noscroll=true}else{if(v&&v.match(/scroll/)){z.noscroll=false}}if(v&&v.match(/noerror/)){z.noerror=true}if(v&&v.match(/isform/)){z.isform=true}if(v&&v.match(/noresponse/)){z.noresponse=true}return z};var p=function(w,z,E){var x="";if(E.url){return E.url}if(w.attr("href")){x=w.prop("href");i.extend(true,E.params,i.jalios.Http.toQueryParams(x));x=x.split("?").shift()}var y=w.prop("form");if(E.isform){y=w.closest("FORM")}if(y){var F=i(y);x=F.attr("action");var v=i.Event("jalios:refresh");v.refresh={};v.refresh.type="serialize";v.refresh.url=x;v.refresh.target=z;v.refresh.options=E;i(document).trigger(v);i.extend(true,E.params,F.serializeObject());if(E.trigger){var B=i(E.trigger);if(B.is('BUTTON, INPUT[type="submit"]')){E.params[B.prop("name")]=B.prop("value")}}}if(z.isPortlet()){x="jcore/portal/ajaxPortal.jsp";E.params.portletId=z.getJcmsId();E.params.portletDomId=z.identify().attr("id");var A=z.getUsage();if(A){E.params.usage=A}}var C=z.children("A.ajax-refresh-url").first();if(C.exists()){x=C.prop("href")}var D=z.attr("data-jalios-ajax-refresh-url");if(D){x=D}var D=w.attr("data-jalios-ajax-refresh-url");if(D){x=D}return x};var h=function(A,y){var y=i.extend(true,{},y);var x=i(A);if(!x.exists()){return false}if(x.hasClass("disabled")){return false}var v=u(x,y);if(!v||!v.exists()){return false}y=l(x,v,y);var w=p(x,v,y);if(!y.confirm&&x.hasClass("confirm")&&y._broked){var z=function(B){if(!B){return}y.confirm=true;i.jalios.AjaxRefresh.refresh(w,v,y)};if(x.closest("DIV.modal").exists()){i.jalios.ui.Modal.confirmInModal(x,z)}else{i.jalios.ui.Modal.open(x,{confirm:true,callback:z})}return true}return i.jalios.AjaxRefresh.refresh(w,v,y)};var j=function(w){var v=i.jalios.Event.match(w,"broker",s,true);if(!v){return}var x=v.source.currentTarget;v.options._broked=true;if(!v.options.target){v.options.target=v.target}i(x).refresh(v.options)};var o=function(w){var v=i(w.currentTarget);if(!h(v,{_broked:true})){return}w.preventDefault();w.stopPropagation();w.stopImmediatePropagation()};var d=function(){var w=i(document);var v=i(document.body);if(i.jalios.Browser.isIE(8)||v.hasClass("browser-IE7")||v.hasClass("browser-IE8")){c()}w.on("jalios:broker",j);w.on("click","A.ajax-refresh",o);w.on("click",":button.ajax-refresh, :submit.ajax-refresh, :image.ajax-refresh",o);i("DIV.ajax-refresh-div.ajax-lazy").refresh({nohistory:true,noscroll:true});w.idleTimer(20000,{name:"LiveRefresh"});w.on("LiveRefresh.active",function(){i("DIV.ajax-refresh-div.ajax-live").refresh({nohistory:true,noscroll:true,noerror:true})});q(w)};var c=function(){i(document).on("submit","FORM",function(x){if(i(this).attr("onsubmit")){return}var w=i(this).find("[type=submit], [type=image]").filter(".ajax-refresh");var v=i(this).find("[type=submit], [type=image]").filter('[data-jalios-action~="ajax-refresh"]');var y=w.exists()||v.exists();if(!w.exists()&&!v.exists()){return}x.preventDefault();x.stopPropagation();x.stopImmediatePropagation();var z=w.add(v);if(z.is(".focus")){z.filter(".focus").refresh()}else{z.first().refresh()}})};var q=function(v){v.find("A.ajax-include").each(function(){var w=i(this).removeClass("ajax-include");if(w.closest(".popover").exists()){return}var x=i('<div class="ajax-include-div"></div>');w.refresh({target:x,noscroll:true,nohistory:true,callback:function(){w.replaceWith(x)}})})};i.jalios.AjaxRefresh={refreshPortlet:function(v,w){return !i("DIV.ajax-refresh-div.ID_"+v).refresh({nohistory:true,callback:w})},refreshTarget:function(w){var v=u(i(w));if(v){v.refresh()}},refresh:function(y,B,x){if(!y){return false}var w=i(B);if(!w.exists()){return false}x=i.extend(true,{},t,x);var C=y.indexOf("?");if(C>0){var v=y.substring(C+1);y=y.substring(0,C);i.extend(true,x.params,i.jalios.Http.toQueryParams(v))}var A=i.Event("jalios:refresh");A.refresh={};A.refresh.type="before";A.refresh.url=y;A.refresh.target=w;A.refresh.options=x;i(document).trigger(A);i.jalios.AjaxRefresh.LastRefresh=A;if(A.isPropagationStopped()){return true}if(!x.noresponse){if(!f(w,true,x)){return true}}b(w,true);if(A.refresh.url.indexOf("http")!=0){y=i.jalios.Http.getBaseUrl()+A.refresh.url}var z=i.ajax({url:y,type:x.method===undefined?"POST":x.method,data:x.params,traditional:true,cache:x.cache,timeout:x.timeout});z.done(function(H){A.refresh.type="success";A.refresh.html=H;i(document).trigger(A);if(x.noresponse){b(w);if(x.callback){x.callback(w,false)}return true}var F=function(I){if(!I){return false}var J=I.indexOf("<html");return J!=-1&&J<200};if(F(A.refresh.html)){A.refresh.type="fail";i(document).trigger(A);if(x.noerror){i.console.warn(I18N.glp("warn.json.sessiontimeout"))}else{alert(I18N.glp("warn.json.sessiontimeout"))}b(w);return false}var E=a(A.refresh.html);var D=E.html;A.refresh.html=D;if(i.jalios.Common.blank(D)){b(w);if(x.callback){x.callback(w,false)}f(w,false,x);return false}var G=function(){if(x.inner){i(x.inner).after(D).remove()}else{if(x.append){w.append(D)}else{w.html(D)}}if(E.$wrap){var J=E.$wrap[0];for(var I=0;I<J.attributes.length;I++){var L=J.attributes[I];if(!L.specified){continue}if(L.name=="class"){continue}w.attr(L.name,L.value)}w.updateClass(J.className);e(w,x)}r(y,w,x);b(w);f(w,false,x);q(w);A.refresh.type="after";i(document).trigger(A);if(x.callback){x.callback(w,D)}if(x.periodical&&x.periodical>0){var M=x.periodical;x.periodical=undefined;var K=function(){var N=i(x.trigger);x.noerror=true;h(N.exists()?N:w,x)};(M<30)?K.delay(M):K.postpone(M)}};x.waiting&&i("HTML").hasClass("cssanimations")?G.delay(x.waiting):G()});z.fail(function(E,F){var D=E&&!E.getAllResponseHeaders();if(D){return}A.refresh.type="fail";i(document).trigger(A);if(x.noerror){i.console.warn(I18N.glp("warn.json.sessiontimeout"))}else{alert(I18N.glp("warn.json.sessiontimeout"))}b(w)});return true}};i.fn.refresh=function(v){return this.each(function(){h(i(this),v)})};i(document).ready(function(v){d()})}(window.jQuery);jQuery(document).on("jalios:refresh",function(b){if(!b||!b.refresh){return false}if(!Event.observe){return false}var c=b.refresh;try{if(c.type=="before"){var d=b.refresh.target.first().identify().attr("id");$(document).fire("refresh:before",{wrapper:d})}else{if(c.type=="after"){var d=b.refresh.target.first().identify().attr("id");$(document).fire("refresh:after",{wrapper:d})}}}catch(a){jQuery.console.error("AjaxRefresh","Exception while firing refresh:after",a)}});JCMS=JCMS||{};JCMS.ajax=JCMS.ajax||{};JCMS.ajax.Refresh=JCMS.ajax.Refresh||{};JCMS.ajax.Refresh.getFragment=function(b){jQuery.console.warn("[Deprecated] getFragment() Should use new Ajax-Refresh");jQuery.console.stacktrace();var a=$(document.body);if(b&&b.refresh){return $(b.refresh.target[0])}return a};JCMS.ajax.Refresh.refreshDIV=function(b,a){jQuery.console.warn("[Deprecated] refreshDIV() Should use new Ajax-Refresh");jQuery.console.stacktrace();jQuery(b).refresh({url:a})};JCMS.ajax.Refresh._request=function(c,b,a){jQuery.console.warn("[Deprecated] _request Should use new Ajax-Refresh",c);jQuery.console.stacktrace();a.url=b;a.target=c;jQuery(c).refresh(a)};JCMS.ajax.Refresh.refreshFromInput=function(a,b,c){jQuery.console.warn("[Deprecated] refreshFromInput() Should use new Ajax-Refresh");jQuery.console.stacktrace();jQuery(a).refresh({target:b,callback:c})};