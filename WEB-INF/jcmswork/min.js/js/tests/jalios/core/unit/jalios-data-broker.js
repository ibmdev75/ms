var mock=function(c){stop(5000);var b=function(d){ok(c(d));$(document).off("jalios:broker",b);start()};var a=function(d){ok(!c(d));$(document).off("jalios:broker",b);start()};$(document).on("jalios:broker",b);return a};$(function(){module("jalios-data-broker:link");test("should trigger action on left click on link",function(){mock(function(a){return a.broker});$("#link1").trigger({type:"click",which:1})});test("should not trigger action on right click on link",function(){var a=mock(function(b){return false});$("#link1").trigger({type:"click",which:3});setTimeout(function(){a()},1000)});test("should trigger action on click on img's link",function(){mock(function(a){return $(a.broker.source.currentTarget).prop("tagName")=="A"});$("#img1").trigger({type:"click",which:1})});module("jalios-data-broker:button");test("should trigger action on left click on button",function(){mock(function(a){return a.broker});$("#btn1").trigger({type:"click",which:1})});test("should trigger action on left click on input button",function(){mock(function(a){return a.broker});$("#btn2").trigger({type:"click",which:1})});test("should trigger action on left click on input submit",function(){mock(function(a){return a.broker});$("#btn3").trigger({type:"click",which:1})});test("should NOT trigger action on change on Buttons",function(){var a=mock(function(b){return false});$("#btn1").trigger({type:"change"});setTimeout(function(){a()},1000)});test("should NOT trigger action on focusin on Buttons",function(){var a=mock(function(b){return false});$("#btn1").trigger({type:"focusin"});setTimeout(function(){a()},1000)});module("jalios-data-broker:div");test("should trigger action on left click on DIV",function(){mock(function(a){return a.broker});$("#div1").trigger({type:"click",which:1})});module("jalios-data-broker:input");test("should trigger action on focusin on Input",function(){mock(function(a){return a.broker});$("#input1").trigger({type:"focusin"})});test("should trigger action on focusout on Input",function(){mock(function(a){return a.broker});$("#input1").trigger({type:"focusout"})});test("should trigger action on focusin on textarea",function(){mock(function(a){return a.broker});$("#input2").trigger({type:"focusin"})});test("should trigger action on focusout on textarea",function(){mock(function(a){return a.broker});$("#input2").trigger({type:"focusout"})});test("should trigger action on change on select",function(){mock(function(a){return a.broker});$("#input3").trigger({type:"change"})});test("should trigger action on change on checkbox",function(){mock(function(a){return a.broker});$("#check1").trigger({type:"change"})});test("should trigger action on change on radio",function(){mock(function(a){return a.broker});$("#radio1").trigger({type:"change"})});module("jalios-data-broker:data");test("should trigger action 'unit-action'",function(){mock(function(c){var b=c.broker;if(!b){return false}var d=b.source;if(!d){return false}var a=$(d.currentTarget);if(!a){return false}equal(a.prop("tagName"),"A","Check the tagName");equal(b.type,"unit-action","Check the broker action");equal(b.target,"A#link2","Check the broker target expresion");equal(b.position,"html","Check the broker position");return true});$("#link2").trigger({type:"click",which:1})})});