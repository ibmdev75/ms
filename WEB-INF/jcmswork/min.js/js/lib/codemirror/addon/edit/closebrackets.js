(function(a){if(typeof exports=="object"&&typeof module=="object"){a(require("../../lib/codemirror"))}else{if(typeof define=="function"&&define.amd){define(["../../lib/codemirror"],a)}else{a(CodeMirror)}}})(function(b){var g="()[]{}''\"\"";var a="[]{}";var f=/\s/;b.defineOption("autoCloseBrackets",false,function(h,m,i){if(i!=b.Init&&i){h.removeKeyMap("autoCloseBrackets")}if(!m){return}var k=g,j=a;if(typeof m=="string"){k=m}else{if(typeof m=="object"){if(m.pairs!=null){k=m.pairs}if(m.explode!=null){j=m.explode}}}var l=e(k);if(j){l.Enter=c(j)}h.addKeyMap(l)});function d(h,j){var i=h.getRange(b.Pos(j.line,j.ch-1),b.Pos(j.line,j.ch+1));return i.length==2?i:null}function e(k){var l={name:"autoCloseBrackets",Backspace:function(m){if(m.getOption("disableInput")){return b.Pass}var n=m.listSelections();for(var o=0;o<n.length;o++){if(!n[o].empty()){return b.Pass}var p=d(m,n[o].head);if(!p||k.indexOf(p)%2!=0){return b.Pass}}for(var o=n.length-1;o>=0;o--){var q=n[o].head;m.replaceRange("",b.Pos(q.line,q.ch-1),b.Pos(q.line,q.ch+1))}}};var j="";for(var h=0;h<k.length;h+=2){(function(m,i){if(m!=i){j+=i}l["'"+m+"'"]=function(u){if(u.getOption("disableInput")){return b.Pass}var n=u.listSelections(),s,q;for(var p=0;p<n.length;p++){var r=n[p],v=r.head,t;if(m=="'"&&u.getTokenTypeAt(v)=="comment"){return b.Pass}var q=u.getRange(v,b.Pos(v.line,v.ch+1));if(!r.empty()){t="surround"}else{if(m==i&&q==i){t="skip"}else{if(m==i&&b.isWordChar(q)){return b.Pass}else{if(u.getLine(v.line).length==v.ch||j.indexOf(q)>=0||f.test(q)){t="both"}else{return b.Pass}}}}if(!s){s=t}else{if(s!=t){return b.Pass}}}if(s=="skip"){u.execCommand("goCharRight")}else{if(s=="surround"){var o=u.getSelections();for(var p=0;p<o.length;p++){o[p]=m+o[p]+i}u.replaceSelections(o,"around")}else{if(s=="both"){u.replaceSelection(m+i,null);u.execCommand("goCharLeft")}}}};if(m!=i){l["'"+i+"'"]=function(n){var o=n.listSelections();for(var q=0;q<o.length;q++){var p=o[q];if(!p.empty()||n.getRange(p.head,b.Pos(p.head.line,p.head.ch+1))!=i){return b.Pass}}n.execCommand("goCharRight")}}})(k.charAt(h),k.charAt(h+1))}return l}function c(h){return function(j){if(j.getOption("disableInput")){return b.Pass}var k=j.listSelections();for(var l=0;l<k.length;l++){if(!k[l].empty()){return b.Pass}var m=d(j,k[l].head);if(!m||h.indexOf(m)%2!=0){return b.Pass}}j.operation(function(){j.replaceSelection("\n\n",null);j.execCommand("goCharLeft");k=j.listSelections();for(var o=0;o<k.length;o++){var n=k[o].head.line;j.indentLine(n,null,true);j.indentLine(n+1,null,true)}})}}});